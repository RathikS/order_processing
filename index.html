<!-- @model List<YourProjectNamespace.Models.Order>
    @{
        ViewData["Title"] = "Order Management";
        var role = ViewBag.Role as string ?? "customer";
    }
    
    <!DOCTYPE html>
    <html>
    <head>
        <meta charset="utf-8" />
        <title>@ViewData["Title"]</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    </head>
    <body class="p-4">
        <div class="container">
            <h2>@ViewData["Title"]</h2>
    
            @if (role == "admin")
            {
                <div class="card my-4 p-3">
                    <h5>Create New Order</h5>
                    <form id="createOrderForm">
                        <div class="mb-3">
                            <label class="form-label">User ID</label>
                            <input type="number" class="form-control" id="userId" required />
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Total Amount</label>
                            <input type="number" class="form-control" id="totalAmount" step="0.01" required />
                        </div>
                        <button type="submit" class="btn btn-primary">Create</button>
                    </form>
                </div>
            }
    
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>Order ID</th>
                        <th>User ID</th>
                        <th>Total Amount</th>
                        <th>Order Date</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="orderTable">
                    @foreach (var order in Model)
                    {
                        <tr data-id="@order.OrderId">
                            <td><a href="/Order/Details?orderId=@order.OrderId">@order.OrderId</a></td>
                            <td>@order.UserId</td>
                            <td>@order.TotalAmount</td>
                            <td>@order.OrderDate.ToShortDateString()</td>
                            <td>
                                @if (role == "admin")
                                {
                                    <select class="form-select status-dropdown">
                                        @{
                                            var statuses = new[] { "PENDING", "SHIPPED", "DELIVERED", "CANCELLED" };
                                            foreach (var status in statuses)
                                            {
                                                <option value="@status" @(order.Status == status ? "selected" : "")>@status</option>
                                            }
                                        }
                                    </select>
                                }
                                else
                                {
                                    @order.Status
                                }
                            </td>
                            <td>
                                @if (role == "admin")
                                {
                                    <button class="btn btn-danger btn-sm delete-btn">Delete</button>
                                }
                                else
                                {
                                    <span>-</span>
                                }
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    
        <script>
            $(function () {
                $('#createOrderForm').on('submit', function (e) {
                    e.preventDefault();
                    $.post('/Order/Create', {
                        userId: $('#userId').val(),
                        totalAmount: $('#totalAmount').val()
                    }, function () {
                        location.reload();
                    });
                });
    
                $('.status-dropdown').on('change', function () {
                    var row = $(this).closest('tr');
                    var orderId = row.data('id');
                    var status = $(this).val();
                    $.post('/Order/UpdateStatus', { orderId, status }, function () {
                        alert('Status updated');
                    });
                });
    
                $('.delete-btn').on('click', function () {
                    if (!confirm("Are you sure?")) return;
                    var orderId = $(this).closest('tr').data('id');
                    $.post('/Order/Delete', { orderId }, function () {
                        location.reload();
                    });
                });
            });
        </script>
    </body>
    </html>
     -->